var Client;(()=>{"use strict";var e={d:(t,n)=>{for(var a in n)e.o(n,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:n[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function n(e){e.preventDefault();let t,n,a=document.getElementById("city").value,i=document.getElementById("schedule").value;Client.validationEmptyInput(a,i)||Client.getApiKey().then((e=>{Client.getLatLongFromGeonamesAPI(e.keyGeonames,a).then((r=>{if(Client.isNotFoundLatLng(r))Client.render404();else{const o={lat:r.geonames[0].lat,lng:r.geonames[0].lng,days:Client.getDays(i)};Client.getPredictForecastFromWeatherbitAPI(e.keyWeatherbit,o).then((({data:r})=>{t=r[r.length-1],Client.getCityImageFromPixabayAPI(e.keyPixabay,a).then((e=>{Client.isNotFoundPicture(e)?Client.render404():(n=Client.getPicturesByCity(e.hits,a),0===n.length?Client.render404():Client.renderResultsUI({forecast:t,pictures:n,city:a,date:i}))}))}))}}))})),document.getElementById("city").value="",document.getElementById("schedule").value=""}e.r(t),e.d(t,{app:()=>a,getApiKey:()=>i,getCityImageFromPixabayAPI:()=>s,getDays:()=>l,getLatLongFromGeonamesAPI:()=>r,getPicturesByCity:()=>d,getPredictForecastFromWeatherbitAPI:()=>o,handleSubmit:()=>n,isNotFoundLatLng:()=>g,isNotFoundPicture:()=>p,navigation:()=>u,printDate:()=>y,render404:()=>h,renderResultsUI:()=>m,validationEmptyInput:()=>c});const a=()=>{document.getElementById("search-btn").addEventListener("click",n),document.getElementById("to-form").addEventListener("click",(e=>{e.preventDefault(),Client.navigation("form")}))},i=async()=>{const e=await fetch("http://localhost:8081/apiKey");return await e.json()},r=async(e,t)=>{const n=await fetch(`http://api.geonames.org/searchJSON?style=SHORT&username=${e}&maxRows=1&q=${t}`);return await n.json()},o=async(e,t)=>{const{lat:n,lng:a,days:i}=t,r=await fetch(`https://api.weatherbit.io/v2.0/forecast/daily?key=${e}&lat=${n}&lon=${a}&days=${i}`);return await r.json()},s=async(e,t)=>{const n=await fetch(`https://pixabay.com/api/?key=${e}&q=${t}&image_type=photo&pretty=true`);return await n.json()},l=e=>{const t=new Date,n=new Date(e);return Math.round(Math.abs((n-t)/864e5))},d=(e,t)=>e.reduce(((e,n)=>(n.tags.includes(t.toLowerCase())&&n.webformatWidth>n.webformatHeight&&e.push(n),e)),[]),c=(e,t)=>(""===e&&""===t||""===e||""===t)&&(alert("Please provided a city name and a travel date"),!0),y=e=>{const t=e.split("-"),n=t[0],a=t[1];return`${t[2]}/${a}/${n}`},m=e=>{Client.navigation("results");const{forecast:t,pictures:n,city:a,date:i}=e,r=Client.printDate(i);document.getElementById("results").innerHTML=`\n  <div class="card">\n    <div id="pic" class="picture">\n      <div class="img-wrap">\n        <img\n          src="${n[n.length-1].webformatURL}"\n        />\n      </div>\n    </div>\n    <div id="info" class="info">\n      <h1>My trip to : ${a.toUpperCase()}</h1>\n      <h3>Departing: ${r}</h3>\n      <p>Typical weather for then is:</p>\n      <h4>High temperature: ${t.max_temp} °C</h4>\n      <h4>Low temperature: ${t.low_temp} °C</h4>\n      <h4>Weather: ${t.weather.description}</h4>\n    </div>\n  </div>\n  `},u=e=>{const t=document.getElementById("form-input"),n=document.getElementById("results"),a=document.getElementById("to-form");"results"===e?(t.style.display="none",n.style.display="flex",a.style.display="block"):"form"===e&&(t.style.display="flex",n.style.display="none",a.style.display="none")},g=e=>0===e.geonames.length,p=e=>0===e.hits.length,h=()=>{Client.navigation("results");document.getElementById("results").innerHTML='\n  <div class="card">\n    <div class="picture">\n      <div class="img-wrap">\n        <img\n          src="https://previews.123rf.com/images/kaymosk/kaymosk1804/kaymosk180400006/100130939-error-404-page-not-found-error-with-glitch-effect-on-screen-vector-illustration-for-your-design-.jpg"\n        />\n      </div>\n    </div>\n    <div class="info">\n      <h1>Your search is not found</h1>\n      <h3>Please try again</h3>\n    </div>\n  </div>\n  '};a(),Client=t})();